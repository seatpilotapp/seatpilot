route:
  group_by: ['alertname', 'tenant', 'channel', 'view']
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 2h
  receiver: slack_default
  routes:
    - receiver: stdout
      continue: true

receivers:
  - name: slack_default
    slack_configs:
      - api_url: '{{ env "ALERT_SLACK_WEBHOOK" }}'
        channel: '{{ env "ALERT_SLACK_CHANNEL" }}'
        send_resolved: true
        title: "[{{ .Status | toUpper }}] {{ .CommonAnnotations.summary }}"
        text: "{{ range .Alerts }}â€¢ Afecta: stage={{ .Labels.stage }}, tenant={{ .Labels.tenant }}, channel={{ .Labels.channel }} ({{ .Annotations.description }})\n{{ end }}"

  - name: stdout
    webhook_configs:
      - url: 'http://alert-echo:8081/'
